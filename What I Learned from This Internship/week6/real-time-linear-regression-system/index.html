<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-Time Linear Regression System</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;600&display=swap" rel="stylesheet">

    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root {
            --neon-blue: #00f3ff;
            --neon-purple: #bc13fe;
            --deep-space: #050b14;
            --glass-bg: rgba(13, 20, 35, 0.7);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        body {
            background-color: var(--deep-space);
            color: #e2e8f0;
            font-family: 'Rajdhani', sans-serif;
            overflow-x: hidden;
        }

        h1, h2, h3, .stat-value {
            font-family: 'Orbitron', sans-serif;
        }

        /* Animated Star Background */
        .stars, .twinkling {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: block;
        }

        .stars {
            background: #000 url('http://www.script-tutorials.com/demos/360/images/stars.png') repeat top center;
            z-index: -2;
        }

        .twinkling {
            background: transparent url('http://www.script-tutorials.com/demos/360/images/twinkling.png') repeat top center;
            z-index: -1;
            animation: move-twink-back 200s linear infinite;
            opacity: 0.6;
        }

        @keyframes move-twink-back {
            from {background-position:0 0;}
            to {background-position:-10000px 5000px;}
        }

        /* Glassmorphism Cards */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.2);
            border-color: rgba(0, 243, 255, 0.3);
        }

        /* Neon Text Utilities */
        .text-neon-blue {
            color: var(--neon-blue);
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
        }
        
        .text-neon-purple {
            color: var(--neon-purple);
            text-shadow: 0 0 10px rgba(188, 19, 254, 0.5);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0b1120; 
        }
        ::-webkit-scrollbar-thumb {
            background: #1e293b; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--neon-blue); 
        }

        /* Chart Container */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .grid-bg {
            background-image: linear-gradient(rgba(0, 243, 255, 0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0, 243, 255, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        /* File Input Styling */
        .file-upload-btn {
            position: relative;
            overflow: hidden;
            display: inline-block;
            cursor: pointer;
        }
        
        .file-upload-btn input[type=file] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            cursor: pointer;
            height: 100%;
            width: 100%;
        }

        a.footer-link {
            color: var(--neon-blue);
            text-decoration: none;
            transition: color 0.3s;
        }
        a.footer-link:hover {
            color: #fff;
            text-shadow: 0 0 8px var(--neon-blue);
        }
    </style>
</head>
<body class="min-h-screen relative">

    <!-- Background Elements -->
    <div class="stars"></div>
    <div class="twinkling"></div>

    <!-- Main Content -->
    <main class="relative z-10 container mx-auto px-4 py-8">
        
        <!-- Header -->
        <header class="flex flex-col lg:flex-row justify-between items-center mb-12 glass-card p-6 border-b-4 border-b-[#00f3ff]">
            <div class="flex items-center gap-4 mb-4 lg:mb-0">
                <div class="p-3 bg-blue-900/30 rounded-full border border-cyan-500/50">
                    <i data-lucide="activity" class="w-10 h-10 text-neon-blue"></i>
                </div>
                <div>
                    <h1 class="text-2xl md:text-4xl font-black tracking-wider uppercase bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 to-purple-500">
                        Real-Time Linear Regression System
                    </h1>
                    <p class="text-cyan-200/70 text-sm tracking-[0.2em] uppercase">Cosmic Data Analysis</p>
                </div>
            </div>
            
            <div class="flex flex-col items-end gap-2">
                <!-- File Uploader -->
                <div class="flex flex-col sm:flex-row gap-4 items-center">
                    <div class="file-upload-btn glass-card px-6 py-3 bg-blue-600/20 hover:bg-blue-600/40 border border-blue-400 transition-colors">
                        <span class="flex items-center gap-2 text-neon-blue font-bold uppercase tracking-wider text-sm">
                            <i data-lucide="upload-cloud" class="w-4 h-4"></i> Upload CSV
                        </span>
                        <input type="file" id="csvFileInput" accept=".csv">
                    </div>

                    <div class="text-right hidden sm:block">
                        <p class="text-xs text-gray-400 uppercase tracking-widest">Data Points</p>
                        <p class="text-neon-purple font-bold text-xl" id="totalRecords">Loading...</p>
                    </div>
                </div>
                <!-- Disclaimer -->
                <p class="text-[10px] text-gray-400 max-w-xs text-right mt-1">
                    <i data-lucide="info" class="w-3 h-3 inline mr-1"></i>
                    Uses default dataset <span class="text-gray-300">cosmicclassifierTest.csv</span>. You can upload your own dataset to see your own output.
                </p>
            </div>
        </header>

        <!-- KPI Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
            <!-- Card 1 -->
            <div class="glass-card p-6 flex flex-col justify-between h-36 relative overflow-hidden group">
                <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                    <i data-lucide="thermometer" class="w-24 h-24"></i>
                </div>
                <h3 class="text-gray-400 text-xs uppercase tracking-wider">Avg Surface Temp (Norm)</h3>
                <div class="flex items-end gap-2">
                    <span class="text-4xl font-bold text-white stat-value" id="avgTemp">--</span>
                    <span class="text-cyan-400 mb-1 text-xs">σ</span>
                </div>
                <div class="w-full bg-gray-700/50 h-1 mt-4 rounded-full overflow-hidden">
                    <div class="bg-gradient-to-r from-blue-500 to-red-500 h-full w-[50%]" id="tempBar"></div>
                </div>
                <p class="text-xs text-gray-500 mt-2">Normalized Value</p>
            </div>

            <!-- Card 2 -->
            <div class="glass-card p-6 flex flex-col justify-between h-36 relative overflow-hidden group">
                <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                    <i data-lucide="weight" class="w-24 h-24"></i>
                </div>
                <h3 class="text-gray-400 text-xs uppercase tracking-wider">Avg Gravity (Norm)</h3>
                <div class="flex items-end gap-2">
                    <span class="text-4xl font-bold text-white stat-value" id="avgGravity">--</span>
                    <span class="text-purple-400 mb-1 text-xs">σ</span>
                </div>
                <div class="w-full bg-gray-700/50 h-1 mt-4 rounded-full overflow-hidden">
                    <div class="bg-gradient-to-r from-purple-500 to-pink-500 h-full w-[50%]" id="gravBar"></div>
                </div>
                <p class="text-xs text-gray-500 mt-2">Normalized Value</p>
            </div>

            <!-- Card 3 -->
            <div class="glass-card p-6 flex flex-col justify-between h-36 relative overflow-hidden group">
                <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                    <i data-lucide="droplets" class="w-24 h-24"></i>
                </div>
                <h3 class="text-gray-400 text-xs uppercase tracking-wider">High Water Content</h3>
                <div class="flex items-end gap-2">
                    <span class="text-4xl font-bold text-white stat-value" id="waterWorlds">--</span>
                    <span class="text-blue-400 mb-1 text-xs">Records</span>
                </div>
                <div class="w-full bg-gray-700/50 h-1 mt-4 rounded-full overflow-hidden">
                    <div class="bg-gradient-to-r from-cyan-400 to-blue-600 h-full" style="width: 0%" id="waterBar"></div>
                </div>
                <p class="text-xs text-gray-500 mt-2">Value > 0.0 (Above Avg)</p>
            </div>

            <!-- Card 4 -->
            <div class="glass-card p-6 flex flex-col justify-between h-36 relative overflow-hidden group border-l-4 border-l-green-400">
                <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                    <i data-lucide="leaf" class="w-24 h-24"></i>
                </div>
                <h3 class="text-gray-400 text-xs uppercase tracking-wider">Potential Candidates</h3>
                <div class="flex items-end gap-2">
                    <span class="text-4xl font-bold text-green-400 stat-value" id="habitableCount">--</span>
                    <span class="text-gray-400 mb-1 text-xs">Planets</span>
                </div>
                <p class="text-xs text-green-300/70 mt-2">Temp near mean (±0.5) & Water > 0</p>
            </div>
        </div>

        <!-- Main Chart Section -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            
            <!-- Large Main Chart -->
            <div class="lg:col-span-2 glass-card p-6">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h2 class="text-xl font-bold text-white flex items-center gap-2">
                            <i data-lucide="scatter-chart" class="w-5 h-5 text-neon-blue"></i>
                            Habitability Correlation
                        </h2>
                        <p class="text-sm text-gray-400">Surface Temperature vs. Water Content (Normalized)</p>
                    </div>
                </div>
                <div class="chart-container grid-bg rounded-lg p-2">
                    <canvas id="scatterChart"></canvas>
                </div>
            </div>

            <!-- Side Chart -->
            <div class="glass-card p-6 flex flex-col">
                <h2 class="text-xl font-bold text-white mb-2 flex items-center gap-2">
                    <i data-lucide="pie-chart" class="w-5 h-5 text-neon-purple"></i>
                    Magnetic Classification
                </h2>
                <p class="text-sm text-gray-400 mb-6">Distribution by Magnetic Field Strength</p>
                <div class="chart-container flex-grow relative">
                    <canvas id="doughnutChart"></canvas>
                    <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                        <span class="text-2xl font-bold text-white" id="categoryCount">--</span>
                        <span class="text-xs text-gray-400">Categories</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Row Charts -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            
            <!-- Radar Chart -->
            <div class="glass-card p-6">
                <h2 class="text-xl font-bold text-white mb-6 flex items-center gap-2">
                    <i data-lucide="radar" class="w-5 h-5 text-orange-400"></i>
                    Environmental Profile (Avg)
                </h2>
                <div class="chart-container">
                    <canvas id="radarChart"></canvas>
                </div>
            </div>

            <!-- Bar Chart -->
            <div class="glass-card p-6">
                <h2 class="text-xl font-bold text-white mb-6 flex items-center gap-2">
                    <i data-lucide="bar-chart-2" class="w-5 h-5 text-pink-400"></i>
                    Radiation Level Analysis
                </h2>
                <p class="text-sm text-gray-400 mb-4">Frequency of Radiation Categories</p>
                <div class="chart-container">
                    <canvas id="barChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-12 border-t border-gray-800 pt-8 pb-4 text-center text-gray-500 text-sm">
            <p class="mb-2">Side project work done by <strong class="text-white">BHUVANESH M</strong> during the <span class="text-neon-purple">GenAI Internship</span></p>
            <p class="flex items-center justify-center gap-2">
                <i data-lucide="github" class="w-4 h-4"></i>
                <a href="https://github.com/bhuvanesh-m-dev/genai-intern-zeno-talent" target="_blank" class="footer-link">
                    https://github.com/bhuvanesh-m-dev/genai-intern-zeno-talent
                </a>
            </p>
        </footer>

    </main>

    <!-- Script for Data & Charts -->
    <script>
        // Initialize Lucide Icons
        lucide.createIcons();

        // --- GLOBAL VARIABLES ---
        let charts = {};
        
        // --- FALLBACK DATA ---
        // Used if local file cannot be fetched
        const defaultCSV = `Atmospheric Density,Surface Temperature,Gravity,Water Content,Mineral Abundance,Orbital Period,Proximity to Star,Magnetic Field Strength,Radiation Levels,Atmospheric Composition Index
-1.303074,2.9325397,-0.16804317,-1.2202495,-1.9426618,0.95047295,1.5407825,Category_13,Category_6,-0.7298093
0.08112391,-3.7473903,-0.59889746,1.5634873,-0.19995251,-1.8449258,1.0953493,Category_11,Category_10,-0.34185022
-3.709952,-1.6895875,0.25949872,1.0200456,-2.0945647,0.34464067,-0.09422738,Category_9,Category_9,-0.53265834
4.8388042,0.44290873,0.9953115,-0.38527206,-0.8180648,-1.903998,2.72779,Category_10,Category_11,0.12747568
-0.78299546,-2.732162,-2.4322886,1.8927116,0.71982104,1.823695,0.71982104,Category_9,Category_8,2.472667
-0.27561113,3.7639992,0.6090673,-1.0407305,1.6025931,-0.865709,-1.7661005,Category_8,Category_6,-1.0704291
-0.21467492,0.34119415,1.878936,-3.7208147,-0.20678307,-1.143025,-0.16535193,Category_11,Category_10,0.5405044
1.7886096,-1.2952839,4.043743,1.1028566,2.617482,-3.2111685,0.83649504,Category_10,Category_11,0.12747568
-2.0461707,1.6479132,-0.24384388,0.5,0.5,0.5,0.5,Category_5,Category_2,0.1`;

        // --- PARSING LOGIC ---
        function parseCSV(text) {
            const lines = text.trim().split('\n');
            const headers = lines[0].split(',').map(h => h.trim());
            
            return lines.slice(1).map(line => {
                const values = line.split(',');
                const obj = {};
                // Handle basic CSV parsing (ignoring complex quotes for this demo)
                if (values.length < headers.length) return null; // Skip empty/malformed lines
                
                headers.forEach((header, index) => {
                    const val = values[index] ? values[index].trim() : '';
                    // Try parsing as number, if NaN keep as string (for Categories)
                    const num = parseFloat(val);
                    obj[header] = isNaN(num) ? val : num;
                });
                return obj;
            }).filter(row => row && row['Surface Temperature'] !== undefined); 
        }

        // --- PROCESSING DATA FOR VISUALS ---
        function processData(data) {
            // Update Totals
            document.getElementById('totalRecords').innerText = data.length.toLocaleString();

            // 1. Calculate Averages for KPI
            const sumTemp = data.reduce((acc, row) => acc + (row['Surface Temperature'] || 0), 0);
            const avgTemp = sumTemp / data.length;
            
            const sumGrav = data.reduce((acc, row) => acc + (row['Gravity'] || 0), 0);
            const avgGrav = sumGrav / data.length;

            const highWater = data.filter(row => row['Water Content'] > 0).length;

            // Logic: "Candidates" = Temp near 0 (mean) and Water > 0
            const candidates = data.filter(row => 
                Math.abs(row['Surface Temperature']) < 0.5 && row['Water Content'] > 0
            );

            // Update DOM
            document.getElementById('avgTemp').innerText = avgTemp.toFixed(2);
            document.getElementById('avgGravity').innerText = avgGrav.toFixed(2);
            document.getElementById('waterWorlds').innerText = highWater;
            document.getElementById('habitableCount').innerText = candidates.length;

            // Update Progress Bars
            document.getElementById('waterBar').style.width = `${Math.min((highWater / data.length) * 100, 100)}%`;

            // 2. Prepare Chart Data
            
            // Scatter: Temp vs Water
            const scatterData = data.map(row => ({
                x: row['Surface Temperature'],
                y: row['Water Content']
            }));

            // Doughnut: Magnetic Field Strength Categories
            const magCounts = {};
            data.forEach(row => {
                const cat = row['Magnetic Field Strength'] || 'Unknown';
                magCounts[cat] = (magCounts[cat] || 0) + 1;
            });
            document.getElementById('categoryCount').innerText = Object.keys(magCounts).length;

            // Bar: Radiation Level Counts
            const radCounts = {};
            data.forEach(row => {
                const cat = row['Radiation Levels'] || 'Unknown';
                radCounts[cat] = (radCounts[cat] || 0) + 1;
            });

            // Radar: Averages of 5 numeric columns
            const radarLabels = ['Gravity', 'Atmospheric Density', 'Orbital Period', 'Mineral Abundance', 'Proximity to Star'];
            const radarAvgs = radarLabels.map(label => {
                const sum = data.reduce((acc, row) => acc + (row[label] || 0), 0);
                return sum / data.length;
            });

            return {
                scatter: scatterData,
                doughnut: { labels: Object.keys(magCounts), data: Object.values(magCounts) },
                bar: { labels: Object.keys(radCounts), data: Object.values(radCounts) },
                radar: { labels: radarLabels, data: radarAvgs },
                candidates: candidates.map(c => ({x: c['Surface Temperature'], y: c['Water Content']}))
            };
        }

        // --- RENDER CHARTS ---
        function renderCharts(processed) {
            Chart.defaults.color = '#94a3b8';
            Chart.defaults.font.family = 'Rajdhani';
            Chart.defaults.borderColor = 'rgba(148, 163, 184, 0.1)';

            // Destroy old charts if exist
            if(charts.scatter) charts.scatter.destroy();
            if(charts.doughnut) charts.doughnut.destroy();
            if(charts.radar) charts.radar.destroy();
            if(charts.bar) charts.bar.destroy();

            // 1. Scatter Chart
            const ctxScatter = document.getElementById('scatterChart').getContext('2d');
            charts.scatter = new Chart(ctxScatter, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'Standard Data Points',
                            data: processed.scatter,
                            backgroundColor: '#3b82f6',
                            pointRadius: 4,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'Potential Candidates',
                            data: processed.candidates,
                            backgroundColor: '#4ade80',
                            pointRadius: 6,
                            pointHoverRadius: 8,
                            pointBorderColor: '#fff'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { title: { display: true, text: 'Surface Temp (Norm)', color: '#00f3ff' }, grid: { color: 'rgba(0, 243, 255, 0.1)' } },
                        y: { title: { display: true, text: 'Water Content (Norm)', color: '#00f3ff' }, grid: { color: 'rgba(0, 243, 255, 0.1)' } }
                    }
                }
            });

            // 2. Doughnut Chart (Magnetic Field)
            const ctxDoughnut = document.getElementById('doughnutChart').getContext('2d');
            charts.doughnut = new Chart(ctxDoughnut, {
                type: 'doughnut',
                data: {
                    labels: processed.doughnut.labels,
                    datasets: [{
                        data: processed.doughnut.data,
                        backgroundColor: [
                            '#3b82f6', '#ef4444', '#10b981', '#f59e0b', '#8b5cf6', '#ec4899', '#06b6d4', '#6366f1'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: { legend: { position: 'bottom', labels: { boxWidth: 10, padding: 10, font: {size: 10} } } }
                }
            });

            // 3. Radar Chart (Avg Attributes)
            const ctxRadar = document.getElementById('radarChart').getContext('2d');
            charts.radar = new Chart(ctxRadar, {
                type: 'radar',
                data: {
                    labels: processed.radar.labels,
                    datasets: [{
                        label: 'Dataset Average',
                        data: processed.radar.data,
                        backgroundColor: 'rgba(255, 159, 64, 0.2)',
                        borderColor: 'rgba(255, 159, 64, 1)',
                        pointBackgroundColor: 'rgba(255, 159, 64, 1)',
                        pointBorderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(255, 255, 255, 0.1)' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            pointLabels: { color: '#e2e8f0', font: { size: 10 } },
                            ticks: { display: false } 
                        }
                    }
                }
            });

            // 4. Bar Chart (Radiation Levels)
            const ctxBar = document.getElementById('barChart').getContext('2d');
            charts.bar = new Chart(ctxBar, {
                type: 'bar',
                data: {
                    labels: processed.bar.labels,
                    datasets: [{
                        label: 'Count',
                        data: processed.bar.data,
                        backgroundColor: '#8b5cf6',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, grid: { color: 'rgba(255, 255, 255, 0.05)' } },
                        x: { grid: { display: false } }
                    }
                }
            });
        }

        // --- INIT ---
        
        // Function to attempt fetching the file
        async function initDashboard() {
            try {
                // Try fetching the file from the same directory
                const response = await fetch('cosmicclassifierTest.csv');
                if (!response.ok) throw new Error("File not found");
                
                const text = await response.text();
                const data = parseCSV(text);
                
                if(data && data.length > 0) {
                    console.log("Loaded cosmicclassifierTest.csv from server");
                    const processed = processData(data);
                    renderCharts(processed);
                    return;
                }
            } catch (err) {
                console.log("Could not load local file, using fallback snippet. Error:", err);
            }

            // Fallback
            console.log("Using embedded fallback data");
            const initialData = parseCSV(defaultCSV);
            const processedInitial = processData(initialData);
            renderCharts(processedInitial);
        }

        // Run Init
        initDashboard();

        // Handle File Upload
        document.getElementById('csvFileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const text = e.target.result;
                const data = parseCSV(text);
                const processed = processData(data);
                renderCharts(processed);
            };
            reader.readAsText(file);
        });

    </script>
</body>
</html>